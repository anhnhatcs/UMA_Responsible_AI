Log files: logs/visa_wall_2701956.out/err (Mode: custom)
==========================================
THE VISA WALL: LLM BIAS EVALUATION
==========================================
Job ID: 2701956
Job Name: visa_wall_bias
Node: uc3n081
Partition: gpu_h100
GPU(s): 4
CPUs: 
Memory:  MB
Workspace: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI
Start Time: Wed Dec 31 10:15:13 PM CET 2025
==========================================

Loading modules...
Modules loaded âœ“

Setting up Python environment...
Activated venv: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv

Model Cache Configuration:
  Model cache workspace: /pfs/work9/workspace/scratch/ma_anhnnguy-model_cache
  HF_HOME: /pfs/work9/workspace/scratch/ma_anhnnguy-model_cache/huggingface_cache
  Models will be cached persistently across jobs

Clearing stale caches from previous jobs...
  Cache cleanup complete âœ“

Cache directories configured (job-local in $TMPDIR):
  TMPDIR: /scratch/slurm_tmpdir/job_2701956
  SLURM_JOB_ID: 2701956
  HF_HOME: /pfs/work9/workspace/scratch/ma_anhnnguy-model_cache/huggingface_cache (persistent)
  TRANSFORMERS_CACHE: /pfs/work9/workspace/scratch/ma_anhnnguy-model_cache/huggingface_cache/hub (persistent)
  TORCH_COMPILE_CACHE_DIR: /scratch/slurm_tmpdir/job_2701956/torch_compile_2701956 (job-local)
  VLLM_CACHE_ROOT: /scratch/slurm_tmpdir/job_2701956/vllm_2701956 (job-local)

Environment Information:
  Python version: Python 3.11.7
  Python path: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/bin/python
  vLLM version: 0.13.0
  CUDA version: V12.8.61

GPU Information:
NVIDIA H100, 95830 MiB, 95304 MiB, 45
NVIDIA H100, 95830 MiB, 95304 MiB, 45
NVIDIA H100, 95830 MiB, 95296 MiB, 46
NVIDIA H100, 95830 MiB, 95304 MiB, 45
==========================================

Pre-flight Checks:
  Python script: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/run_bias_evaluation.py
  Config file: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/config.yaml
  Output dir: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/results
  All packages OK âœ“
==========================================

Run Mode: custom
Runs per candidate: 500
==========================================
Running custom models: gemma2-9b gemma2-27b llama31-8b llama31-70b ministral-8b ministral-14b-reasoning mistral-small qwen3-4b qwen3-8b qwen3-30b qwen3-32b
Extra-large model detected (70B) - using tensor_parallel=4, gpu_memory=0.85
Gemma model detected - adding --enforce-eager for softcapping support

Executing command:
python /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/run_bias_evaluation.py             --config /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/config.yaml             --models gemma2-9b gemma2-27b llama31-8b llama31-70b ministral-8b ministral-14b-reasoning mistral-small qwen3-4b qwen3-8b qwen3-30b qwen3-32b             --runs 500             --output /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/results             --gpu-memory 0.85             --tensor-parallel 4             --max-model-len 4096 --enforce-eager
==========================================
âœ“ Logged in to HuggingFace successfully
============================================================
THE VISA WALL: LLM Bias Evaluation
============================================================
Config: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/config.yaml
Models: ['gemma2-9b', 'gemma2-27b', 'llama31-8b', 'llama31-70b', 'ministral-8b', 'ministral-14b-reasoning', 'mistral-small', 'qwen3-4b', 'qwen3-8b', 'qwen3-30b', 'qwen3-32b']
Candidates: ['anonymous', 'lukas', 'andrei', 'mehmet', 'minh', 'wei']
Runs per candidate: 500
Output directory: /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/results
Mitigation tests: True
Max model length: 4096

============================================================
Loading model: gemma2-9b (google/gemma-2-9b-it)
============================================================
  Using max_model_len: 4096
  Using enforce_eager=True (for Gemma 2 softcapping support)
WARNING 12-31 22:17:40 [attention.py:82] Using VLLM_ATTENTION_BACKEND environment variable is deprecated and will be removed in v0.14.0 or v1.0.0, whichever is soonest. Please use --attention-config.backend command line argument or AttentionConfig(backend=...) config field instead.
INFO 12-31 22:17:40 [utils.py:253] non-default args: {'trust_remote_code': True, 'max_model_len': 4096, 'tensor_parallel_size': 4, 'gpu_memory_utilization': 0.85, 'disable_log_stats': True, 'enforce_eager': True, 'model': 'google/gemma-2-9b-it'}
INFO 12-31 22:17:53 [model.py:514] Resolved architecture: Gemma2ForCausalLM
INFO 12-31 22:17:53 [model.py:1661] Using max model len 4096
INFO 12-31 22:17:59 [scheduler.py:230] Chunked prefill is enabled with max_num_batched_tokens=16384.
WARNING 12-31 22:17:59 [vllm.py:622] Enforce eager set, overriding optimization level to -O0
INFO 12-31 22:17:59 [vllm.py:722] Cudagraph is disabled under eager mode
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:02 [core.py:93] Initializing a V1 LLM engine (v0.13.0) with config: model='google/gemma-2-9b-it', speculative_config=None, tokenizer='google/gemma-2-9b-it', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=google/gemma-2-9b-it, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.NONE: 0>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['all'], 'splitting_ops': [], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [16384], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.NONE: 0>, 'cudagraph_num_of_warmups': 0, 'cudagraph_capture_sizes': [], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': False, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 0, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:10 [parallel_state.py:1203] world_size=4 rank=3 local_rank=3 distributed_init_method=tcp://127.0.0.1:41761 backend=nccl
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:10 [parallel_state.py:1203] world_size=4 rank=0 local_rank=0 distributed_init_method=tcp://127.0.0.1:41761 backend=nccl
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:10 [parallel_state.py:1203] world_size=4 rank=2 local_rank=2 distributed_init_method=tcp://127.0.0.1:41761 backend=nccl
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:10 [parallel_state.py:1203] world_size=4 rank=1 local_rank=1 distributed_init_method=tcp://127.0.0.1:41761 backend=nccl
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:12 [pynccl.py:111] vLLM is using nccl==2.27.5
[0;36m(EngineCore_DP0 pid=352578)[0;0m WARNING 12-31 22:18:15 [symm_mem.py:107] SymmMemCommunicator: symmetric memory multicast operations are not supported.
[0;36m(EngineCore_DP0 pid=352578)[0;0m WARNING 12-31 22:18:15 [symm_mem.py:107] SymmMemCommunicator: symmetric memory multicast operations are not supported.
[0;36m(EngineCore_DP0 pid=352578)[0;0m WARNING 12-31 22:18:15 [symm_mem.py:107] SymmMemCommunicator: symmetric memory multicast operations are not supported.
[0;36m(EngineCore_DP0 pid=352578)[0;0m WARNING 12-31 22:18:15 [symm_mem.py:107] SymmMemCommunicator: symmetric memory multicast operations are not supported.
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:16 [parallel_state.py:1411] rank 2 in world size 4 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 2, EP rank 2
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:16 [parallel_state.py:1411] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 0, EP rank 0
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:16 [parallel_state.py:1411] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 1, EP rank 1
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:18:16 [parallel_state.py:1411] rank 3 in world size 4 is assigned as DP rank 0, PP rank 0, PCP rank 0, TP rank 3, EP rank 3
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m INFO 12-31 22:18:28 [gpu_model_runner.py:3562] Starting to load model google/gemma-2-9b-it...
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m INFO 12-31 22:18:31 [cuda.py:315] Using AttentionBackendEnum.FLASH_ATTN backend.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m INFO 12-31 22:18:31 [cuda.py:315] Using AttentionBackendEnum.FLASH_ATTN backend.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m INFO 12-31 22:18:31 [cuda.py:315] Using AttentionBackendEnum.FLASH_ATTN backend.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m INFO 12-31 22:18:31 [cuda.py:315] Using AttentionBackendEnum.FLASH_ATTN backend.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m INFO 12-31 22:18:48 [default_loader.py:308] Loading weights took 15.78 seconds
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m INFO 12-31 22:18:48 [gpu_model_runner.py:3659] Model loading took 4.3499 GiB memory and 19.199268 seconds
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m INFO 12-31 22:19:22 [gpu_worker.py:375] Available KV cache memory: 64.74 GiB
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:19:22 [kv_cache_utils.py:1291] GPU KV cache size: 808,144 tokens
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:19:22 [kv_cache_utils.py:1296] Maximum concurrency for 4,096 tokens per request: 196.92x
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:19:29 [core.py:259] init engine (profile, create kv cache, warmup model) took 41.22 seconds
[0;36m(EngineCore_DP0 pid=352578)[0;0m WARNING 12-31 22:19:30 [vllm.py:629] Inductor compilation was disabled by user settings,Optimizations settings that are only active duringInductor compilation will be ignored.
[0;36m(EngineCore_DP0 pid=352578)[0;0m INFO 12-31 22:19:30 [vllm.py:722] Cudagraph is disabled under eager mode
INFO 12-31 22:19:30 [llm.py:360] Supported tasks: ['generate']

  Evaluating: anonymous (run 1/500)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] WorkerProc hit an exception.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP1 pid=352586)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] 
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] WorkerProc hit an exception.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP2 pid=352588)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] 
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] WorkerProc hit an exception.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP0 pid=352584)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] 
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] WorkerProc hit an exception.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 819, in worker_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                               ^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     self.impl.forward(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824]            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] RuntimeError: This flash attention build does not support tanh softcapping.
[0;36m(EngineCore_DP0 pid=352578)[0;0m [0;36m(Worker_TP3 pid=352590)[0;0m ERROR 12-31 22:19:31 [multiproc_executor.py:824] 
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [dump_input.py:72] Dumping input data for V1 LLM engine (v0.13.0) with config: model='google/gemma-2-9b-it', speculative_config=None, tokenizer='google/gemma-2-9b-it', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None, kv_cache_metrics=False, kv_cache_metrics_sample=0.01, cudagraph_metrics=False, enable_layerwise_nvtx_tracing=False), seed=0, served_model_name=google/gemma-2-9b-it, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.NONE: 0>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['all'], 'splitting_ops': [], 'compile_mm_encoder': False, 'compile_sizes': [], 'compile_ranges_split_points': [16384], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.NONE: 0>, 'cudagraph_num_of_warmups': 0, 'cudagraph_capture_sizes': [], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {'fuse_norm_quant': False, 'fuse_act_quant': False, 'fuse_attn_quant': False, 'eliminate_noops': False, 'enable_sp': False, 'fuse_gemm_comms': False, 'fuse_allreduce_rms': False}, 'max_cudagraph_capture_size': 0, 'dynamic_shapes_config': {'type': <DynamicShapesType.BACKED: 'backed'>, 'evaluate_guards': False}, 'local_cache_dir': None}, 
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [dump_input.py:79] Dumping scheduler output for model execution: SchedulerOutput(scheduled_new_reqs=[NewRequestData(req_id=0,prompt_token_ids_len=225,mm_features=[],sampling_params=SamplingParams(n=1, presence_penalty=0.0, frequency_penalty=0.0, repetition_penalty=1.0, temperature=0.7, top_p=0.9, top_k=0, min_p=0.0, seed=None, stop=['<|eot_id|>', '<|im_end|>', '</s>'], stop_token_ids=[], bad_words=[], include_stop_str_in_output=False, ignore_eos=False, max_tokens=512, min_tokens=0, logprobs=None, prompt_logprobs=None, skip_special_tokens=True, spaces_between_special_tokens=True, truncate_prompt_tokens=None, structured_outputs=None, extra_args=None),block_ids=([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]),num_computed_tokens=0,lora_request=None,prompt_embeds_shape=None)], scheduled_cached_reqs=CachedRequestData(req_ids=[], resumed_req_ids=[], new_token_ids=[], all_token_ids={}, new_block_ids=[], num_computed_tokens=[], num_output_tokens=[]), num_scheduled_tokens={0: 225}, total_num_scheduled_tokens=225, scheduled_spec_decode_tokens={}, scheduled_encoder_inputs={}, num_common_prefix_blocks=[0, 15], finished_req_ids=[], free_encoder_mm_hashes=[], preempted_req_ids=[], pending_structured_output_tokens=false, kv_connector_metadata=null, ec_connector_metadata=null)
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868] EngineCore encountered a fatal error.
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868] Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 859, in run_engine_core
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     engine_core.run_busy_loop()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 886, in run_busy_loop
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     self._process_engine_step()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 919, in _process_engine_step
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     outputs, model_executed = self.step_fn()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]                               ^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 351, in step
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     model_output = future.result()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]                    ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 80, in result
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     return super().result()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]            ^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     return self.__get_result()
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]            ^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     raise self._exception
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 84, in wait_for_response
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     response = self.aggregate(get_response())
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]                               ^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/multiproc_executor.py", line 342, in get_response
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868]     raise RuntimeError(
[0;36m(EngineCore_DP0 pid=352578)[0;0m ERROR 12-31 22:19:31 [core.py:868] RuntimeError: Worker failed with error 'This flash attention build does not support tanh softcapping.', please check the stack trace above for the root cause

==========================================
âœ— Job failed with exit code: 1
  End Time: Wed Dec 31 10:19:34 PM CET 2025

Check logs for details:
  /pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/logs/visa_wall_2701956.err
==========================================

============================= JOB FEEDBACK =============================

NodeName=uc3n081
Job ID: 2701956
Cluster: uc3
User/Group: ma_anhnnguy/ma_ma
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 192
CPU Utilized: 00:03:51
CPU Efficiency: 0.43% of 14:59:12 core-walltime
Job Wall-clock time: 00:04:41
Memory Utilized: 8.34 GB
Memory Efficiency: 1.11% of 755.08 GB (755.08 GB/node)

/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.
[2025-12-28 15:52:04] WARNING _login.py:409: Note: Environment variable`HF_TOKEN` is set and is the current active token independently from the token you've just configured.
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:02<00:07,  2.63s/it]
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:05<00:05,  2.91s/it]
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:08<00:02,  2.83s/it]
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.98s/it]
[0;36m(EngineCore_DP0 pid=233354)[0;0m Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:11<00:00,  2.92s/it]
[0;36m(EngineCore_DP0 pid=233354)[0;0m 
[0;36m(EngineCore_DP0 pid=233354)[0;0m 2025-12-28 15:53:03,345 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
[0;36m(EngineCore_DP0 pid=233354)[0;0m 2025-12-28 15:53:03,371 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
Adding requests:   0%|          | 0/1 [00:00<?, ?it/s]Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 15.80it/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][0;36m(EngineCore_DP0 pid=233354)[0;0m Process EngineCore_DP0:
Traceback (most recent call last):
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/run_bias_evaluation.py", line 584, in <module>
[0;36m(EngineCore_DP0 pid=233354)[0;0m Traceback (most recent call last):
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
[0;36m(EngineCore_DP0 pid=233354)[0;0m     self.run()
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/multiprocessing/process.py", line 108, in run
[0;36m(EngineCore_DP0 pid=233354)[0;0m     self._target(*self._args, **self._kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 870, in run_engine_core
[0;36m(EngineCore_DP0 pid=233354)[0;0m     raise e
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 859, in run_engine_core
[0;36m(EngineCore_DP0 pid=233354)[0;0m     engine_core.run_busy_loop()
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 886, in run_busy_loop
[0;36m(EngineCore_DP0 pid=233354)[0;0m     self._process_engine_step()
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 919, in _process_engine_step
[0;36m(EngineCore_DP0 pid=233354)[0;0m     outputs, model_executed = self.step_fn()
[0;36m(EngineCore_DP0 pid=233354)[0;0m                               ^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 351, in step
[0;36m(EngineCore_DP0 pid=233354)[0;0m     model_output = future.result()
[0;36m(EngineCore_DP0 pid=233354)[0;0m                    ^^^^^^^^^^^^^^^
    main()
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/concurrent/futures/_base.py", line 449, in result
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self.__get_result()
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/run_bias_evaluation.py", line 570, in main
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/opt/bwhpc/common/devel/python/3.11.7_gnu_14.2/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
[0;36m(EngineCore_DP0 pid=233354)[0;0m     raise self._exception
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/executor/uniproc_executor.py", line 79, in collective_rpc
[0;36m(EngineCore_DP0 pid=233354)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/serial_utils.py", line 461, in run_method
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/worker_base.py", line 369, in execute_model
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self.worker.execute_model(scheduler_output, *args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_worker.py", line 623, in execute_model
[0;36m(EngineCore_DP0 pid=233354)[0;0m     output = self.model_runner.execute_model(
[0;36m(EngineCore_DP0 pid=233354)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3087, in execute_model
[0;36m(EngineCore_DP0 pid=233354)[0;0m     model_output = self._model_forward(
[0;36m(EngineCore_DP0 pid=233354)[0;0m                    ^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/worker/gpu_model_runner.py", line 2750, in _model_forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self.model(
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 418, in forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     hidden_states = self.model(
[0;36m(EngineCore_DP0 pid=233354)[0;0m                     ^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/compilation/decorators.py", line 372, in __call__
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self.forward(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    run_evaluation(
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 311, in forward
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/run_bias_evaluation.py", line 342, in run_evaluation
[0;36m(EngineCore_DP0 pid=233354)[0;0m     hidden_states, residual = layer(
[0;36m(EngineCore_DP0 pid=233354)[0;0m                               ^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 242, in forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     hidden_states = self.self_attn(
[0;36m(EngineCore_DP0 pid=233354)[0;0m                     ^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/model_executor/models/gemma2.py", line 184, in forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     attn_output = self.attn(q, k, v)
[0;36m(EngineCore_DP0 pid=233354)[0;0m                   ^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._call_impl(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return forward_call(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 347, in forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     torch.ops.vllm.unified_attention_with_output(
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/utils/kv_transfer_utils.py", line 39, in wrapper
    outputs = llm.generate([full_prompt], sampling_params)
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return func(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/attention/layer.py", line 863, in unified_attention_with_output
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m     self.impl.forward(
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 449, in generate
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/attention/backends/flash_attn.py", line 687, in forward
[0;36m(EngineCore_DP0 pid=233354)[0;0m     flash_attn_varlen_func(
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/vllm_flash_attn/flash_attn_interface.py", line 278, in flash_attn_varlen_func
[0;36m(EngineCore_DP0 pid=233354)[0;0m     out, softmax_lse, _, _ = torch.ops._vllm_fa3_C.fwd(
[0;36m(EngineCore_DP0 pid=233354)[0;0m                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m   File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/torch/_ops.py", line 1255, in __call__
[0;36m(EngineCore_DP0 pid=233354)[0;0m     return self._op(*args, **kwargs)
[0;36m(EngineCore_DP0 pid=233354)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^
[0;36m(EngineCore_DP0 pid=233354)[0;0m RuntimeError: This flash attention build does not support tanh softcapping.
    outputs = self._run_engine(use_tqdm=use_tqdm)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/entrypoints/llm.py", line 1760, in _run_engine
    step_outputs = self.llm_engine.step()
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/llm_engine.py", line 293, in step
    outputs = self.engine_core.get_output()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/work9/workspace/scratch/ma_anhnnguy-topic_modeling_data/RAI/venv/lib/python3.11/site-packages/vllm/v1/engine/core_client.py", line 717, in get_output
    raise self._format_exception(outputs) from None
vllm.v1.engine.exceptions.EngineDeadError: EngineCore encountered an issue. See stack trace (above) for the root cause.
Processed prompts:   0%|          | 0/1 [00:01<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
